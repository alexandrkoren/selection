# selection

## Общее описание подхода
1. **Генерация всевозможных пар.** Полным перебором среди коров и быков выбираются те пары, уровень родства между которыми не более 5%. На данном этапе количество коров на одного быка не учитывается. В результате собирается список, содержащий пару корова-бык и ожидаемое значение EBV.
2. **Сортировка.** Проводится сортировка по убыванию по значению ожидаемого EBV. В итоге выборка максимизирована по среднему значению EBV потомков.
3. **Выборка.** Из полученного списка пар выбираем пары с уникальными коровами. А также учитываем ограничение по использованию быков. В результате получен список пар корова-бык с максимальной средней ожидаемой селекционной ценностью потомства.

## Уровень родства
Для вычисления уровня родства использовалась упрощенная версия подхода [Родственное спаривание](http://www.kgau.ru/distance/zif_03/razvedenie-110401/06_02.html#:~:text=%D0%A0%D0%B0%D0%B9%D1%82%D0%B0%20%D1%81%D1%87%D0%B5%D1%82%20%D1%80%D1%8F%D0%B4%D0%BE%D0%B2%20%D0%BF%D1%80%D0%B5%D0%B4%D0%BA%D0%BE%D0%B2%20%D0%BD%D0%B0%D1%87%D0%B8%D0%BD%D0%B0%D0%B5%D1%82%D1%81%D1%8F,1,55%25%20-%20%D0%BE%D1%82%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%BD%D1%8B%D0%BC.), описанная в [Coefficient of relationship](https://en.wikipedia.org/wiki/Coefficient_of_relationship). 
**Описание алгоритма:**
- Для коровы и быка отдельно собирается словарь всех их родственников. ID животного - это ключ, а поколение предка - значение. Если один предок встречается в разных поколениях, то учитываем наименьшее.
- Затем для каждого общего предка у коровы и быка вычисляется путь от текущего животного до общего предка по формуле $$p_{ij}=\frac1{2^n}$$, где $n$ - поколение общего предка, $i$ - текущее животное, $i \in (cow, bull)$, $j$ - общий предок.
- Уровень родства до предка $j$ вычисляем, как произведение: $$r_j=p_{cow,j} \cdot p_{bull,j}$$
- Уровень родства между текущими коровой и быков - это сумма родства ко всем общим предкам: $$r=\sum_{j}r_j$$